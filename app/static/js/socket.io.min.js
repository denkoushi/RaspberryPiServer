(function(e,t){typeof exports=="object"&&typeof module!="undefined"?module.exports=t():typeof define=="function"&&define.amd?define(t):(e=typeof globalThis!="undefined"?globalThis:e||self,e.io=t())})(this,function(){var e={};function t(n){if(e[n])return e[n].exports;var r=e[n]={exports:{}};return t.memoize&&(t.memoize[n]=r.exports),e[n]=r.exports,n=r.exports}return t.memoize&&(t.memoize={}),t(3284);function n(e){var t;return{lastIndex:e.lastIndex,exec:((t=e.exec)&&(Object.defineProperty(t,"lastIndex",{value:e.lastIndex,configurable:!0})),t)}}t(441);var r=t(4522),o=t(6768);const i="4.7.2";var s=t(6876);class a extends s.AutoConnect{constructor(e,t){super(e),this.reconnection(t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts),this.reconnectionDelay(t.reconnectionDelay),this.reconnectionDelayMax(t.reconnectionDelayMax),this.randomizationFactor(t.randomizationFactor),this.timeout(t.timeout),this._readyState="closed",this._reconnecting=!1,this._reconnectionAttempts=0,this._skipReconnect=!1}get readyState(){return this._readyState}set readyState(e){this._readyState=e,this.emitReserved("readyStateChanged",e)}applyOptions(e){super.applyOptions(e),this.reconnection(e.reconnection),this.reconnectionAttempts(e.reconnectionAttempts),this.reconnectionDelay(e.reconnectionDelay),this.reconnectionDelayMax(e.reconnectionDelayMax),this.randomizationFactor(e.randomizationFactor),this.timeout(e.timeout)}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts}reconnectionDelay(e){return arguments.length?(this._reconnectionDelay=e,this):this._reconnectionDelay}randomizationFactor(e){return arguments.length?(this._randomizationFactor=e,this):this._randomizationFactor}reconnectionDelayMax(e){return arguments.length?(this._reconnectionDelayMax=e,this):this._reconnectionDelayMax}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}connect(){this._readyState!=="open"&&this._readyState!=="opening"&&(this._readyState="opening",super.connect())}_ensureOpen(){super._ensureOpen(),this._readyState==="opening"&&(this._readyState="open",this.emitReserved("readyStateChanged","open"))}close(){this._skipReconnect=!0,this._readyState="closing",super.close()}onclose(e){super.onclose(e),this._reconnecting=!1,this._readyState="closed",this.emitReserved("readyStateChanged","closed"),this._reconnection&&!this._skipReconnect&&this._reconnectionAttempts<this._reconnectionAttempts&&this._readyState!=="closed"&&(this._reconnecting=!0,this.emitReserved("reconnect_attempt",this._reconnectionAttempts+1),this._reconnectionAttempts++,this._reconnect())}_reconnect(){if(!this._reconnecting||this._reconnectionAttempts>=this._reconnectionAttempts)return;const e=this._reconnectionDelay;let t=e+(Math.random()-0.5)*2*e*this._randomizationFactor;t=Math.min(t,this._reconnectionDelayMax),setTimeout(()=>{this._skipReconnect||this._readyState==="closed"||(super.connect(),this._reconnecting=!1,this.emitReserved("reconnect",this._reconnectionAttempts),this._reconnectionAttempts=0)},t)}onopen(){super.onopen(),this._readyState==="opening"&&(this._readyState="open",this.emitReserved("readyStateChanged","open"))}}var c=t(4522);function u(e,t,n){return Math.max(t,Math.min(n,e))}var l=t(6876);const f={connectTimeout:3e4,reconnection:!0,reconnectionAttempts:1/0,reconnectionDelay:1e3,reconnectionDelayMax:5e3,randomizationFactor:.5,autoConnect:!0,insecure:!1,withCredentials:!1,timeout:2e4,transports:void 0,transportOptions:{},rememberUpgrade:!1};class d extends l.Manager{constructor(e,t={}){if(typeof e=="object"){t=e,e=void 0}else t={...f,...t};super(e,t),this.ids=0,this.subs=[],this.nsps={}}socket(e,t){const n=this.nsps[e];return n?n:(this.nsps[e]=this.createSocket(e,t),this.nsps[e])}createSocket(e,t){const n=new p(this,e,t);return this._reconnectOnOpen(n),n}destroy(e){this.subs=[],super.destroy(e),delete this.nsps[e.nsp]}_reconnectOnOpen(e){this._readyState==="open"?e.open():this.once("open",()=>{e.open()})}}o.Manager=d;class p extends r.Socket{constructor(e,t,n){super(e,t,n),this.connectTimeout=n?.connectTimeout??f.connectTimeout,this.connecting=!1,this.id=++e.ids,this._initListeners()}_initListeners(){this.io.on("reconnect_attempt",()=>{this.connecting=!0}),this.io.on("reconnect_failed",()=>{this.connecting=!1}),this.on("connect_error",()=>{this.connecting=!1}),this.on("connect_timeout",()=>{this.connecting=!1})}open(){return this.connect(),this}connect(){return this.connecting||(this.connecting=!0,this.subs.push(this.once("connect",()=>{this.connecting=!1}))),super.connect(),this}disconnect(){return this.connecting=!1,super.disconnect()}close(){return this.disconnect()}}o.Socket=p;function h(e,t){return e.io.engine?t.apply(e):reconnect(e,()=>t.apply(e))}function reconnect(e,t){const n=e.reconnectionAttempts(),r=e.reconnectionDelay(),o=e.reconnectionDelayMax();let i=0,s=r;const a=()=>{if(i>=n)return;const u=Date.now();t(),i++,s=u+Math.min(o,u+s)-u,setTimeout(a,s)};return a(),()=>{i=n}}function g(e,t){const n="[object Function]"===Object.prototype.toString.call(t),r={};for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(n&&t.call(null,s,e[s])||(r[s]=e[s]));return r}o.connect=function(e,t){const n=new d(e,t);return n.autoConnect&&n.connect(),n},o.protocol=i,typeof window<"u"&&(window.io=o);return o});
